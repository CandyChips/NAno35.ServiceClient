@using Nano35.HttpContext.storage
@using Nano35.WebClient.Services
@using Nano35.HttpContext.instance
@inject HttpClient HttpClient
@inject IRequestManager RequestManager
@inject ISessionProvider SessionProvider


<RadzenFieldset Text="Оприходуемые товары"
                Style="width: 60rem">
    <RadzenGrid Data="@_details"
                EmptyText="Добавте оприходуемые товары..."
                TItem="ComingDetailViewModel">
        <Columns>
            <RadzenGridColumn TItem="ComingDetailViewModel"
                              Property="StorageItem" 
                              Title="Товар" />
            <RadzenGridColumn TItem="ComingDetailViewModel" 
                              Property="PlaceOnStorage" 
                              Title="Место на складе" />
            <RadzenGridColumn TItem="ComingDetailViewModel"
                              Property="Count"
                              Title="Количество" />
            <RadzenGridColumn TItem="ComingDetailViewModel"
                              Property="Price" 
                              Title="Цена" />
        </Columns>
    </RadzenGrid>
</RadzenFieldset>

@code
{
    [Parameter] public ComingViewModel Coming { get; set; }
    private List<ComingDetailViewModel> _details = new List<ComingDetailViewModel>();
    
    protected override async Task OnInitializedAsync()
    {
        _details = (await (new GetAllComingDetailsRequest(
            RequestManager, 
            HttpClient, 
            new GetComingDetailsByIdHttpQuery() 
            {Id = Coming.Id}))
            .Send())
            .Data;
    }
}
