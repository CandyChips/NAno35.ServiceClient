@using Nano35.WebClient.Services
@using Nano35.HttpContext.Repair
@using Nano35.HttpContext.instance
@inject HttpClient HttpClient
@inject IRequestManager RequestManager
@inject ISessionProvider SessionProvider

<WorkForm FormSubmitted="Submit"
            Model="_model" 
            Error="@Error"/>

@code
{
    private CreateWorkBody _model = new()
    {
        NewId = Guid.NewGuid(),
        InstanceId = Guid.Empty
    };
    
    private string Error { get; set; }
    
    private async Task Submit()
    {
        //try
        //{
        //    var typesResponse = await new HttpRequestWrapper<CreateWorkBody, CreateWorkSuccessResponse>(HttpClient, $"{RequestManager.InstanceServer}/InstancesTypes").GetAsync();
        //    if (typesResponse.IsSuccess())
        //    {
        //        
        //    }
        //    else
        //    {
        //        
        //    }
        //}
        //catch (Exception e)
        //{
        //    Error = e.Message;
        //}
    }
    
    protected override async Task OnInitializedAsync()
    {
        _model = new CreateWorkBody
        {
            NewId = Guid.NewGuid(),
            InstanceId = await SessionProvider.GetCurrentInstanceId()
        };
    }
}
