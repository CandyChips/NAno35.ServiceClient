@using Nano35.WebClient.Services
@using Nano35.HttpContext.instance
@inject HttpClient HttpClient
@inject IRequestManager RequestManager
@inject ISessionProvider SessionProvider

<InstancesForm FormSubmitted="Submit"
            Model="_model" 
            Error="@Error"/>

@code
{
    private CreateInstanceHttpBody _model;
    private string Error { get; set; }
    
    private async Task Submit()
    {
        try
        {
            await new HttpPostRequest<CreateInstanceHttpBody,CreateInstanceHttpResponse>(HttpClient, $"{RequestManager.InstanceServer}/Instances").PostAsync(_model);
        }
        catch (Exception e)
        {
            Error = e.Message;
        }
    }
    
    protected override void OnInitialized()
    {
        _model = new CreateInstanceHttpBody { NewId = Guid.NewGuid() };
    }
}
