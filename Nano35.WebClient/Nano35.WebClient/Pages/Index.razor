@page "/"
@using System.ComponentModel.DataAnnotations

<AuthorizeView>
    <NavLink class="btn btn-secondary" href="instances">
        Организации
    </NavLink>
</AuthorizeView>
      
<EditForm Model="@Model" 
      OnValidSubmit="() => { }">
    <DataAnnotationsValidator />
    <InputField Title="Номер телефона">
        <Controls>
            <RadzenTextBox Style="width: 100%;" 
                           Placeholder="..."
                           @bind-Value="Model.Phone"/>
        </Controls>
        <Validation>
            <ValidationMessage For="@(() => Model.Phone)" />
        </Validation>
    </InputField>
        
    <RadzenButton type="submit"
                  Text="Создать"
                  ButtonStyle="ButtonStyle.Primary"
                  Style="width: 100%" />
</EditForm>  
@Phone
@code
{
    public Phones Model { get; set; } = new Phones() { Phone = "" };
    private string Phone
    {
        get
        {
            var tmp = string.Concat(Model.Phone
                .AsEnumerable()
                .Select(f => f.ToString())
                .Where(f => int.TryParse(f, out _)));
            return tmp.Length < 11 || tmp.Length > 11 ? "" : tmp.Substring(1, 10);
        }
    }

    public class Phones
    {
        [RegularExpression(@"^((8|\+7)[\- ]?)?(\(?\d{3}\)?[\- ]?)?[\d\- ]{7,10}$", ErrorMessage = "Введите корректный номер телефона клиента")]
        public string Phone { get; set; }
    }
}
